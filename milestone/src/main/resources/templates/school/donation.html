<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>보육원 | 결제</title>
    <link rel="stylesheet" type="text/css"
          href="//p25.zdassets.com/hc/theming_assets/9204604/360002309011/style.css?digest=12256508972825">
</head>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1"/>

<link href="/css/school/schoolDonation.css" rel="stylesheet"/>

<link rel="stylesheet" href="/css/fix/header.css">
<link rel="stylesheet" href="/css/fix/footer.css">
<link rel="stylesheet" href="/css/fix/menu.css"/>
<link rel="icon" href="/imgs/fix/favicon.png">

<body>
<header th:replace="/fix/header.html :: header"></header>

<div class="wholePage">

    <div class="title">결제하기</div>

    <div class="wrapper">
        <div class="long">
            <section class="leftFirst">
                <div style="width:736px">
                    <h3 id="miniTitle">기부내역</h3>
                    <div class="secWrapper">
                        <div class="schoolImg">
                            <img data-type="1-1" width="386px" height="auto"
                                 src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQahV0-oS2Aq2g6lri5oICW5DbPtgb1Xa1Dew&usqp=CAU">
                        </div>
                        <div class="schoolInfo">
                            <input type="hidden" id="userId" th:value="${schoolDTO.userId}">
                            <h4 id="schoolName">명륜보육원</h4>
                            <h5 class="schoolAddress">
                                <span class="schoolAddress">서울시 강남구 역삼동</span>
                                <!-- <br> -->
                                <span class="schoolAddress schoolAddressDetail">테헤란로 146 현익빌딩 3,4층</span>
                            </h5>
                            <div style="margin-left:10px">
                                <div>
                                    <ul>
                                        <li>∙ 연 예산 : <span id="budget">100,000,000</span>&nbsp;원</li>
                                        <li>∙ 계좌번호 : <span id="accountNum">394203-11-342423</span>&nbsp;<span id="bank">국민</span>
                                        </li>
                                        <li>∙ 교사 인원 : <span id="teacher">10</span>&nbsp;명</li>
                                        <li>∙ 아이들 인원 : <span id="children">20</span>&nbsp;명</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

        </div>

        <div class="rightLong">
            <div class="innerRight">
                <h5 class="innrRightIn">
                    <span>총 기부 금액</span>
                    <span class="pay"></span>
                </h5>
                <h5 class="innrRightIn">
                    <span><input type="text" class="amountInput" id="amountInputMoney"
                                 placeholder="기부하실 금액을 입력하세요"></span>
                    <span class="cash">원</span>
                </h5>
                <div id="justBorder"></div>
                <h5 class="innrRightIn">
                    <span>총 결제금액</span>
                    <div>
                        <span class="totalAmount" id="totalAmountMoney"></span>&nbsp;&nbsp;원
                    </div>
                </h5>
                <div class="checkOk">
                    <div>
                        <input type="checkbox">
                    </div>
                    <div id="checkOk2">
                        주문 내용을 확인하였으며, 결제에 동의합니다. (필수)
                    </div>
                </div>
                <div>
                    <button class="orderButton"><span id="payButton" style="font-weight:bolder;">결제하기</span></button>
                </div>
                <p class="endMent">결제하기 버튼을 누르시면 보육원에게 기부금이 전달됩니다.</p>
            </div>
        </div>


    </div>


</div>

<footer th:replace="/fix/footer.html :: footer"></footer>
</body>
<script src="https://js.bootpay.co.kr/bootpay-4.2.6.min.js" type="application/javascript"></script>
<script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script src="/js/school/schoolDonation.js"></script>
<script src="/js/fix/header.js"></script>
<script>
    // 부트페이 결제 api
    // import { Bootpay } from '@bootpay/client-js'
    // (Bootpay.requestPayment)

    test();


    function test() {

        const response = Bootpay.requestPayment({
            "application_id": "6390c5f2d01c7e001ffeb8a2",
            "price": 1000,
            "order_name": "테스트결제",
            "order_id": "TEST_ORDER_ID",
            "pg": "케이씨피",
            "method": "카드",
            "tax_free": 0,
            "user": {
                "id": "회원아이디",
                "username": "회원이름",
                "phone": "01000000000",
                "email": "test@test.com"
            },
            "items": [
                {
                    "id": "item_id",
                    "name": "테스트아이템",
                    "qty": 1,
                    "price": 1000
                }
            ],
            "extra": {
                "open_type": "redirect",
                "redirect_url": "/school/list",
                "card_quota": "0,2,3",
                "escrow": false,
                "display_success_result":true,
                "display_error_result":true

            }
            // extra: {
            //     open_type: 'iframe',
            //     browser_open_type: [
            //         {
            //             browser: 'instagram',
            //             open_type: 'redirect'
            //         },
            //         {
            //             browser: 'facebook',
            //             open_type: 'redirect'
            //         },
            //         {
            //             browser: 'kakaotalk',
            //             open_type: 'popup'
            //         },
            //         {
            //             browser: 'naver',
            //             open_type: 'popup'
            //         },
            //         {
            //             browser: 'mobile_safari',
            //             open_type: 'popup'
            //         },
            //         {
            //             browser: 'mobile_chrome',
            //             open_type: 'iframe'
            //         }
            //     ],
            //     redirect_url: '/school/list'
            // }
        })
    }

    // BootPay.request({
    //     price: '1000', //실제 결제되는 가격
    //     application_id: '593f8febe13f332431a8ddae',
    //     name: '블링블링 마스카라', //결제창에서 보여질 이름
    //     pg: 'danal',
    //     show_agree_window: 0, // 부트페이 정보 동의 창 보이기 여부
    //     items: [
    //         {
    //             item_name: '나는 아이템', //상품명
    //             qty: 1, //수량
    //             unique: '123', //해당 상품을 구분짓는 primary key
    //             price: 1000, //상품 단가
    //             cat1: 'TOP', // 대표 상품의 카테고리 상, 50글자 이내
    //             cat2: '티셔츠', // 대표 상품의 카테고리 중, 50글자 이내
    //             cat3: '라운드 티', // 대표상품의 카테고리 하, 50글자 이내
    //         }
    //     ],
    //     user_info: {
    //         username: '사용자 이름',
    //         email: '사용자 이메일',
    //         addr: '사용자 주소',
    //         phone: '010-1234-4567'
    //     },
    //     method: 'card', //결제수단, 입력하지 않으면 결제수단 선택부터 화면이 시작합니다.
    //     order_id: '고유order_id_1234', //관리하시는 고유 주문번호를 입력해주세요
    //     params: {
    //         callback1: '그대로 콜백받을 변수 1',
    //         callback2: '그대로 콜백받을 변수 2',
    //         customvar1234: '변수명도 마음대로'
    //     },
    // }).error(function (data) {
    //     //결제 진행시 에러가 발생하면 수행됩니다.
    //     console.log(data);
    // }).cancel(function (data) {
    //     //결제가 취소되면 수행됩니다.
    //     console.log(data);
    // }).confirm(function (data) {
    //     //결제가 실행되기 전에 수행되며, 주로 재고를 확인하는 로직이 들어갑니다.
    //     //주의 - 카드 수기결제일 경우 이 부분이 실행되지 않습니다.
    //     console.log(data);
    //     if(somthing) { // 재고 수량 관리 로직 혹은 다른 처리
    //         this.transactionConfirm(data); // 조건이 맞으면 승인 처리를 한다.
    //     } else {
    //         this.removeWindow(); // 조건이 맞지 않으면 결제 창을 닫고 결제를 승인하지 않는다.
    //     }
    // }).done(function (data) {
    //     //결제가 정상적으로 완료되면 수행됩니다
    //     //비즈니스 로직을 수행하기 전에 결제 유효성 검증을 하시길 추천합니다.
    //     console.log(data);
    // });

</script>
<script th:inline="javascript">

    function schoolInfo(schoolDTO) {
        $('#schoolName').html(schoolDTO.schoolName)
        $('.schoolAddress').html(schoolDTO.schoolAddress)
        $('.schoolAddressDetail').html(schoolDTO.schoolAddressDetail)
        $('#budget').html(schoolDTO.schoolBudget)
        $('#accountNum').html(schoolDTO.schoolAccount)
        $('#bank').html(schoolDTO.schoolBank)
        $('#teacher').html(schoolDTO.schoolTeachers)
        $('#children').html(schoolDTO.schoolKids)
    }

    getSchoolInfo($('#userId').val(), schoolInfo)


</script>
</html>